<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>LC 567 – Permutation in String (Interactive)</title>

  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    body { background:#f3f4f6; font-family:Inter,system-ui; }
    .cell { min-width:48px; min-height:48px; display:flex; align-items:center; justify-content:center; border:1px solid #e5e7eb; background:#fff; border-radius:6px; }
    .cell.current { background:#e0f2fe; border-color:#38bdf8; transform:scale(1.08); }
    .panel { background:#fff; border:1px solid #e6e6e6; border-radius:8px; padding:12px; }
    .freq-box { width:32px; height:32px; border:1px solid #e5e7eb; display:flex; align-items:center; justify-content:center; border-radius:4px; margin-left:4px; }
    .match { background:#dcfce7; border-color:#86efac; }
    .freq-vertical { display:flex; align-items:center; margin-bottom:4px; }
  </style>
</head>
<body>
  <div id="root" class="p-6 max-w-5xl mx-auto"></div>

  <script>
  (function(React, ReactDOM){
    const { useState, useRef } = React;

    function computeSteps(s1, s2) {
      const steps = [];
      const n = s1.length;
      const m1 = Array(26).fill(0);
      const m2 = Array(26).fill(0);
      const gi = c => c.charCodeAt(0) - 97;

      for (const c of s1) m1[gi(c)]++;
      steps.push({ action:"init-s1", i: -1, j: -1, m1: [...m1], m2: [...m2], desc:"Build frequency of s1" });

      for (const c of s2.slice(0, n)) m2[gi(c)]++;
      steps.push({ action:"init-window", i:0, j:n-1, m1:[...m1], m2:[...m2], desc:"Build initial window in s2" });

      if (m1.toString() === m2.toString()){
        steps.push({ action:"found", i:0, j:n-1, m1:[...m1], m2:[...m2], desc:"Initial window matches" });
        return steps;
      }

      for (let j = n; j < s2.length; j++){
        const i = j - n;
        m2[gi(s2[j])]++;
        m2[gi(s2[i])]--;
        steps.push({ action:"slide", i:i+1, j:j, m1:[...m1], m2:[...m2], desc:`Slide window → add '${s2[j]}' remove '${s2[i]}'` });
        if (m1.toString() === m2.toString()){
          steps.push({ action:"found", i:i+1, j:j, m1:[...m1], m2:[...m2], desc:`Permutation found at window [${i+1}, ${j}]` });
          return steps;
        }
      }

      steps.push({ action:"done", i:-1, j:-1, m1:[...m1], m2:[...m2], desc:"No permutation found"});
      return steps;
    }

    function App(){
      const [s1, setS1] = useState("ab");
      const [s2, setS2] = useState("eidbaooo");
      const [steps, setSteps] = useState([]);
      const [idx, setIdx] = useState(0);
      const intervalRef = useRef(null);

      function load(){
        const st = computeSteps(s1, s2);
        setSteps(st);
        setIdx(0);
        if (intervalRef.current) clearInterval(intervalRef.current);
      }

      function stepForward(){ if (steps.length) setIdx(i=>Math.min(i+1, steps.length-1)); }
      function stepBack(){ if (steps.length) setIdx(i=>Math.max(i-1,0)); }

      const cur = steps[idx] || {};

      return React.createElement("div", {className:"space-y-6"},
        React.createElement("h1", {className:"text-2xl font-semibold"}, "LC 567 – Permutation in String (Interactive)"),

        React.createElement("div", {className:"grid grid-cols-1 md:grid-cols-4 gap-3"},
          React.createElement("input", {className:"p-2 border rounded", value:s1, onChange:e=>setS1(e.target.value)}),
          React.createElement("input", {className:"p-2 border rounded", value:s2, onChange:e=>setS2(e.target.value)}),
          React.createElement("button", {className:"bg-blue-600 text-white rounded px-3 py-2", onClick:load}, "Load steps"),
          React.createElement("div", {className:"text-sm text-gray-600"}, steps.length?`Step ${idx+1}/${steps.length}`:"–")
        ),

        React.createElement("div", {className:"flex space-x-3"},
          React.createElement("button", {className:"px-3 py-2 border rounded", onClick:stepBack}, "⟵ Back"),
          React.createElement("button", {className:"px-3 py-2 border rounded", onClick:stepForward}, "Forward ⟶")
        ),

        React.createElement("div", {className:"grid grid-cols-1 md:grid-cols-2 gap-4"},

          React.createElement("div", {className:"panel"},
            React.createElement("h2", {className:"font-medium mb-3"}, "s2 Sliding Window"),
            React.createElement("div", {className:"flex flex-wrap gap-2"},
              s2.split('').map((c,i)=>{
                const inWindow = cur.i <= i && i <= cur.j && cur.i>=0;
                return React.createElement("div", {key:i, className:"cell" + (inWindow?" current":"")},
                  React.createElement("div", null,
                    React.createElement("div", null, c),
                    React.createElement("div", {className:"text-xs text-gray-500"}, i)
                  )
                );
              })
            ),
            React.createElement("div", {className:"mt-3 text-sm text-gray-600"}, cur.desc||"–")
          ),

          React.createElement("div", {className:"panel"},
            React.createElement("h2", {className:"font-medium mb-3"}, "Frequency Tables (Vertical)"),
            React.createElement("div", {className:"text-sm text-gray-600 mb-2"}, "Letter · m1 · m2"),
            Array.from({length:26},(_,i)=>React.createElement("div", {key:i, className:"freq-vertical"},
              React.createElement("div", null, String.fromCharCode(97+i)),
              React.createElement("div", {className:"freq-box" + ((cur.m1 && cur.m1[i]>0)?" match":"")}, cur.m1 ? cur.m1[i] : 0),
              React.createElement("div", {className:"freq-box" + ((cur.m2 && cur.m2[i]>0)?" match":"")}, cur.m2 ? cur.m2[i] : 0)
            ))
          )
        )
      );
    }

    ReactDOM.createRoot(document.getElementById('root')).render(React.createElement(App));
  })(window.React, window.ReactDOM);
  </script>
</body>
</html>
